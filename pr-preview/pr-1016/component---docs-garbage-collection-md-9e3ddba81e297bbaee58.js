(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{GAVx:function(e,t,a){"use strict";a.r(t),a.d(t,"_frontmatter",(function(){return m})),a.d(t,"default",(function(){return b}));var n=a("wx14"),r=a("Ff2n"),o=(a("q1tI"),a("7ljp")),l=a("hhGP");a("qKvR");const c=["components"],m={};void 0!==m&&m&&m===Object(m)&&Object.isExtensible(m)&&!Object.prototype.hasOwnProperty.call(m,"__filemeta")&&Object.defineProperty(m,"__filemeta",{configurable:!0,value:{name:"_frontmatter",filename:"docs/garbage-collection.md"}});const i={_frontmatter:m},s=l.a;function b(e){let{components:t}=e,a=Object(r.a)(e,c);return Object(o.b)(s,Object(n.a)({},i,a,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h1",{id:"garbage-collection"},"Garbage collection"),Object(o.b)("p",null,"Tanka can automatically delete resources from your cluster once you remove them\nfrom Jsonnet."),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},Object(o.b)("strong",{parentName:"p"},"Note:")," This feature is ",Object(o.b)("strong",{parentName:"p"},"experimental"),". Please report problems at ",Object(o.b)("a",{parentName:"p",href:"https://github.com/grafana/tanka/issues"},"https://github.com/grafana/tanka/issues"),".")),Object(o.b)("p",null,"To accomplish this, it appends the ",Object(o.b)("inlineCode",{parentName:"p"},"tanka.dev/environment: <hash>")," label to each created\nresource. This is used to identify those which are missing from the local state in the\nfuture."),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},Object(o.b)("strong",{parentName:"p"},"Note:")," The label value changed from the ",Object(o.b)("inlineCode",{parentName:"p"},"<name>")," to a ",Object(o.b)("inlineCode",{parentName:"p"},"<hash>")," in v0.15.0.")),Object(o.b)("p",null,"Because the label causes a ",Object(o.b)("inlineCode",{parentName:"p"},"diff")," for every single object in your cluster and\nnot everybody wants this, it needs to be explicitly enabled. To do so, add the\nfollowing field to your ",Object(o.b)("inlineCode",{parentName:"p"},"spec.json"),":"),Object(o.b)("pre",{className:"material-theme-darker vscode-highlight","data-language":"diff"},Object(o.b)("code",{parentName:"pre",className:"vscode-highlight-code"},Object(o.b)("span",{parentName:"code",className:"vscode-highlight-line"},Object(o.b)("span",{parentName:"span",className:"mtk1"},"{")),"\n",Object(o.b)("span",{parentName:"code",className:"vscode-highlight-line"},Object(o.b)("span",{parentName:"span",className:"mtk1"},'  "spec": {')),"\n",Object(o.b)("span",{parentName:"code",className:"vscode-highlight-line"},Object(o.b)("span",{parentName:"span",className:"mtk5"},"+"),Object(o.b)("span",{parentName:"span",className:"mtk6"},'    "injectLabels": true,')),"\n",Object(o.b)("span",{parentName:"code",className:"vscode-highlight-line"},Object(o.b)("span",{parentName:"span",className:"mtk1"},"  }")),"\n",Object(o.b)("span",{parentName:"code",className:"vscode-highlight-line"},Object(o.b)("span",{parentName:"span",className:"mtk1"},"}")))),Object(o.b)("p",null,"Once added, run a ",Object(o.b)("inlineCode",{parentName:"p"},"tk apply"),", make sure the label is actually added and confirm\nby typing ",Object(o.b)("inlineCode",{parentName:"p"},"yes"),"."),Object(o.b)("p",null,"From now on, you can use ",Object(o.b)("inlineCode",{parentName:"p"},"tk prune")," to remove old resources from your cluster."),Object(o.b)("style",{className:"vscode-highlight-styles"},"\n  \n  .material-theme-darker {\nbackground-color: #212121;\ncolor: #EEFFFF;\n}\n\n.material-theme-darker .mtk1 { color: #FFFFFF; }\n.material-theme-darker .mtk2 { color: #212121; }\n.material-theme-darker .mtk3 { color: #545454; }\n.material-theme-darker .mtk4 { color: #F78C6C; }\n.material-theme-darker .mtk5 { color: #89DDFF; }\n.material-theme-darker .mtk6 { color: #C3E88D; }\n.material-theme-darker .mtk7 { color: #FFCB6B; }\n.material-theme-darker .mtk8 { color: #EEFFFF; }\n.material-theme-darker .mtk9 { color: #82AAFF; }\n.material-theme-darker .mtk10 { color: #FF5370; }\n.material-theme-darker .mtk11 { color: #F07178; }\n.material-theme-darker .mtk12 { color: #C792EA; }\n.material-theme-darker .mtk13 { color: #EEFFFF90; }\n.material-theme-darker .mtk14 { color: #65737E; }\n.material-theme-darker .mtk15 { color: #B2CCD6; }\n.material-theme-darker .mtk16 { color: #C17E70; }\n.material-theme-darker .mtki { font-style: italic; }\n.material-theme-darker .mtkb { font-weight: bold; }\n.material-theme-darker .mtku { text-decoration: underline; text-underline-position: under; }\n"))}void 0!==b&&b&&b===Object(b)&&Object.isExtensible(b)&&!Object.prototype.hasOwnProperty.call(b,"__filemeta")&&Object.defineProperty(b,"__filemeta",{configurable:!0,value:{name:"MDXContent",filename:"docs/garbage-collection.md"}}),b.isMDXComponent=!0}}]);
//# sourceMappingURL=component---docs-garbage-collection-md-9e3ddba81e297bbaee58.js.map