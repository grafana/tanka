{"version":3,"sources":["webpack:///./docs/exporting.md"],"names":["_frontmatter","Object","isExtensible","prototype","hasOwnProperty","call","defineProperty","configurable","value","name","filename","layoutProps","MDXLayout","DefaultLayout","MDXContent","_ref","components","props","_objectWithoutProperties","_excluded","mdx","_extends","mdxType","parentName","isMDXComponent"],"mappings":"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","file":"component---docs-exporting-md-4f402566d86d491f7326.js","sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n/* @jsx mdx */\nimport DefaultLayout from \"/home/runner/work/tanka/tanka/docs/node_modules/gatsby-theme-docz/src/base/Layout.js\";\nexport const _frontmatter = {};\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"exporting-as-yaml\"\n    }}>{`Exporting as YAML`}</h1>\n    <p>{`Tanka provides you with a day-to-day workflow for working with Kubernetes clusters:`}</p>\n    <ul>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`tk show`}</inlineCode>{` for quickly checking the YAML representation looks good`}</li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`tk diff`}</inlineCode>{` to ensure your changes will behave like they should`}</li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`tk apply`}</inlineCode>{` makes it happen`}</li>\n    </ul>\n    <p>{`However sometimes it can be required to integrate with other tooling that does\nonly support `}<inlineCode parentName=\"p\">{`.yaml`}</inlineCode>{` files.`}</p>\n    <p>{`For that case, `}<inlineCode parentName=\"p\">{`tk export`}</inlineCode>{` can be used:`}</p>\n    <pre {...{\n      \"className\": \"material-theme-darker vscode-highlight\",\n      \"data-language\": \"bash\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk3 mtki\"\n          }}>{`#           <outputDir> <environment>`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`$ tk `}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk12\"\n          }}>{`export`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` promtail/   environments/promtail`}</span></span></code></pre>\n    <blockquote>\n      <p parentName=\"blockquote\"><strong parentName=\"p\">{`Note:`}</strong>{` The arguments flipped in v0.14.0, the `}<inlineCode parentName=\"p\">{`<outputDir>`}</inlineCode>{` comes first now.`}</p>\n    </blockquote>\n    <p>{`This will create a separate `}<inlineCode parentName=\"p\">{`.yaml`}</inlineCode>{` file for each Kubernetes resource included in your Jsonnet.`}</p>\n    <h2 {...{\n      \"id\": \"filenames\"\n    }}>{`Filenames`}</h2>\n    <p>{`Tanka by default uses the following pattern:`}</p>\n    <pre {...{\n      \"className\": \"material-theme-darker vscode-highlight\",\n      \"data-language\": \"bash\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk5\"\n          }}>{`\\${`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk8\"\n          }}>{`apiVersion`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk5\"\n          }}>{`}`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`.`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk5\"\n          }}>{`\\${`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk8\"\n          }}>{`kind`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk5\"\n          }}>{`}`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`-`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk5\"\n          }}>{`\\${`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk8\"\n          }}>{`metadata.name`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk5\"\n          }}>{`}`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`.yaml`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}></span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk3 mtki\"\n          }}>{`# examples:`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`apps-v1.Deployment-distributor.yaml`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`v1.ConfigMap-loki.yaml`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`v1.Service-ingester.yaml`}</span></span></code></pre>\n    <p>{`If that does not fit your need, you can provide your own pattern using the `}<inlineCode parentName=\"p\">{`--format`}</inlineCode>{` flag:`}</p>\n    <pre {...{\n      \"className\": \"material-theme-darker vscode-highlight\",\n      \"data-language\": \"bash\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`tk `}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk12\"\n          }}>{`export`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` promtail environments/promtail --format=`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk5\"\n          }}>{`'`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk6\"\n          }}>{`{{.metadata.labels.app}}-{{.metadata.name}}-{{.kind}}`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk5\"\n          }}>{`'`}</span></span></code></pre>\n    <blockquote>\n      <p parentName=\"blockquote\">{`The syntax is Go `}<inlineCode parentName=\"p\">{`text/template`}</inlineCode>{`. See `}<a parentName=\"p\" {...{\n          \"href\": \"https://pkg.go.dev/text/template\"\n        }}>{`https://pkg.go.dev/text/template`}</a>{`\nfor reference.`}</p>\n    </blockquote>\n    <p>{`This would include the label named `}<inlineCode parentName=\"p\">{`app`}</inlineCode>{`, the `}<inlineCode parentName=\"p\">{`name`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`kind`}</inlineCode>{` of the resource:`}</p>\n    <pre {...{\n      \"className\": \"material-theme-darker vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`loki-distributor-Deployment`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`loki-loki-ConfigMap`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`loki-ingester-Service`}</span></code></pre>\n    <p>{`You can optionally use the template function `}<inlineCode parentName=\"p\">{`lower`}</inlineCode>{` for lower-casing fields, e.g. in the above example`}</p>\n    <pre {...{\n      \"className\": \"material-theme-darker vscode-highlight\",\n      \"data-language\": \"bash\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`... --format=`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk5\"\n          }}>{`'`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk6\"\n          }}>{`{{.metadata.labels.app}}-{{.metadata.name}}-{{.kind | lower}}`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk5\"\n          }}>{`'`}</span></span></code></pre>\n    <p>{`would yield`}</p>\n    <pre {...{\n      \"className\": \"material-theme-darker vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`loki-distributor-deployment`}</span></code></pre>\n    <p>{`etc.`}</p>\n    <p>{`You can also use a different file extension by providing `}<inlineCode parentName=\"p\">{`--extension='yml'`}</inlineCode>{`, for example.`}</p>\n    <h2 {...{\n      \"id\": \"multiple-environments\"\n    }}>{`Multiple environments`}</h2>\n    <p>{`Tanka can also export multiple inline environments, as showcased in `}<a parentName=\"p\" {...{\n        \"href\": \"/pr-preview/pr-903/inline-environments#use-case-consistent-inline-environments\"\n      }}>{`Use case: consistent inline\nenvironments`}</a>{`. This follows the same\nprinciples as describe before with the addition that you can also refer to Environment specific data through the `}<inlineCode parentName=\"p\">{`env`}</inlineCode>{`\nkeyword.`}</p>\n    <p>{`For example an export might refer to data from the Environment spec:`}</p>\n    <pre {...{\n      \"className\": \"material-theme-darker vscode-highlight\",\n      \"data-language\": \"bash\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk3 mtki\"\n          }}>{`# Format based on environment {{env.<...>}}`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`$ tk `}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk12\"\n          }}>{`export`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` exportDir environments/dev/ \\\\`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`  --format `}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk5\"\n          }}>{`'`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk6\"\n          }}>{`{{env.metadata.labels.cluster}}/{{env.spec.namespace}}//{{.kind}}-{{.metadata.name}}`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk5\"\n          }}>{`'`}</span></span></code></pre>\n    <p>{`Even more advanced use cases allow you to export multiple environments in a single execution:`}</p>\n    <pre {...{\n      \"className\": \"material-theme-darker vscode-highlight\",\n      \"data-language\": \"bash\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk3 mtki\"\n          }}>{`# Export multiple environments`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`$ tk `}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk12\"\n          }}>{`export`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` exportDir environments/dev/ environments/qa/`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk3 mtki\"\n          }}>{`# Recursive export`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`$ tk `}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk12\"\n          }}>{`export`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` exportDir environments/ --recursive`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk3 mtki\"\n          }}>{`# Recursive export with labelSelector`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`$ tk `}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk12\"\n          }}>{`export`}</span><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{` exportDir environments/ -r -l team=infra`}</span></span></code></pre>\n    <h2 {...{\n      \"id\": \"performance-features\"\n    }}>{`Performance features`}</h2>\n    <p>{`When exporting a large amount of environments, jsonnet evaluation can become a bottleneck. To speed up the process, Tanka provides a few optional features.`}</p>\n    <h3 {...{\n      \"id\": \"partial-export-in-a-gitops-context\"\n    }}>{`Partial export (in a GitOps context)`}</h3>\n    <p>{`Given multiple environments, one may want to only export the environments that were modified since the last export. This is enabled by passing both the `}<inlineCode parentName=\"p\">{`--merge-strategy=replace-envs`}</inlineCode>{` flags.`}</p>\n    <p>{`When these flags are passed, Tanka will:`}</p>\n    <ol>\n      <li parentName=\"ol\">{`Delete the manifests that were previously exported by the environments that are being exported. This is done by looking at the `}<inlineCode parentName=\"li\">{`manifest.json`}</inlineCode>{` file that is generated by Tanka when exporting. The related entries are also removed from the `}<inlineCode parentName=\"li\">{`manifest.json`}</inlineCode>{` file.`}</li>\n      <li parentName=\"ol\">{`Generate the manifests for the targeted environments into the output directory.`}</li>\n      <li parentName=\"ol\">{`Add in the new manifests entries into the `}<inlineCode parentName=\"li\">{`manifest.json`}</inlineCode>{` file and re-export it.`}</li>\n    </ol>\n    <h4 {...{\n      \"id\": \"finding-out-which-environments-to-export\"\n    }}>{`Finding out which environments to export`}</h4>\n    <p>{`Tanka provides the `}<inlineCode parentName=\"p\">{`tk tool importers`}</inlineCode>{` command to figure out which `}<inlineCode parentName=\"p\">{`main.jsonnet`}</inlineCode>{` need to be re-exported based on what files were modified in a workspace.`}</p>\n    <p>{`If, for example, the `}<inlineCode parentName=\"p\">{`lib/my-lib/main.libsonnet`}</inlineCode>{` file was modified, you could run the command like this to find which files to export:`}</p>\n    <pre {...{\n      \"className\": \"material-theme-darker vscode-highlight\",\n      \"data-language\": \"console\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`# Find out which envs to re-export`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`$ tk tool importers lib/my-lib/main.libsonnet`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`my-repo-path/jsonnet/environments/my-env/main.jsonnet`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`# Re-export the envs`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`$ tk export myoutputdir my-repo-path/jsonnet/environments/my-env/main.jsonnet --merge-strategy=replace-envs`}</span></code></pre>\n    <p>{`Note that deleted environments need special consideration when doing this.\nThe `}<inlineCode parentName=\"p\">{`tk tool importers`}</inlineCode>{` utility only works with existing files so deleting an environment will result in stale `}<inlineCode parentName=\"p\">{`manifest.json`}</inlineCode>{` entries and moving an environment will result in manifest conflicts.\nIn order to correctly handle deleted environments, they need to be passed to the export command:`}</p>\n    <pre {...{\n      \"className\": \"material-theme-darker vscode-highlight\",\n      \"data-language\": \"console\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`$ tk export myoutputdir my-repo-path/jsonnet/environments/my-new-env-path/main.jsonnet --merge-strategy=replace-envs \\\\`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`  --merge-deleted-envs my-repo-path/jsonnet/environments/my-old-env-path/main.jsonnet \\\\`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`  --merge-deleted-envs my-repo-path/jsonnet/environments/other-deleted-env-path/main.jsonnet`}</span></code></pre>\n    <h3 {...{\n      \"id\": \"using-a-memory-ballast\"\n    }}>{`Using a memory ballast`}</h3>\n    <p><em parentName=\"p\">{`Read `}<a parentName=\"em\" {...{\n          \"href\": \"https://blog.twitch.tv/en/2019/04/10/go-memory-ballast-how-i-learnt-to-stop-worrying-and-love-the-heap/\"\n        }}>{`this blog post`}</a>{` for more information about memory ballasts.`}</em></p>\n    <p>{`For large environments that load lots of data into memory on evaluation, a memory ballast can dramatically improve performance. This feature is exposed through the `}<inlineCode parentName=\"p\">{`--mem-ballast-size-bytes`}</inlineCode>{` flag on the export command.`}</p>\n    <p>{`Anecdotally (Grafana Labs), environments that took around a minute to load were able to load in around 45 secs with a ballast of 5GB (`}<inlineCode parentName=\"p\">{`--mem-ballast-size-bytes=5368709120`}</inlineCode>{`). Decreasing the ballast size resulted in negative impact on performance, and increasing it more did not result in any noticeable impact.`}</p>\n    <h3 {...{\n      \"id\": \"caching\"\n    }}>{`Caching`}</h3>\n    <p>{`Tanka can also cache the results of the export. This is useful if you often export the same files and want to avoid recomputing them. The cache key is calculated from the main file and all of its transitive imports, so any change to any file possibly used in an environment will invalidate the cache.`}</p>\n    <p>{`This is configured by two flags:`}</p>\n    <ul>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`--cache-path`}</inlineCode>{`: The local filesystem path where the cache will be stored. The cache is a flat directory of json files (one per environment).`}</li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`--cache-envs`}</inlineCode>{`: If exporting multiple environments, this flag can be used to specify, with regexes, which environments to cache. If not specified, all environments are cached.`}</li>\n    </ul>\n    <p>{`Notes:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Using the cache might be slower than evaluating jsonnet directy. It is only recommended for environments that are very CPU intensive to evaluate.`}</li>\n      <li parentName=\"ul\">{`To use object storage, you can point the `}<inlineCode parentName=\"li\">{`--cache-path`}</inlineCode>{` to a FUSE mount, such as `}<a parentName=\"li\" {...{\n          \"href\": \"https://github.com/s3fs-fuse/s3fs-fuse\"\n        }}><inlineCode parentName=\"a\">{`s3fs`}</inlineCode></a></li>\n    </ul>\n\n    <style {...{\n      \"className\": \"vscode-highlight-styles\"\n    }}>{`\n  \n  .material-theme-darker {\nbackground-color: #212121;\ncolor: #EEFFFF;\n}\n\n.material-theme-darker .mtk1 { color: #FFFFFF; }\n.material-theme-darker .mtk2 { color: #212121; }\n.material-theme-darker .mtk3 { color: #545454; }\n.material-theme-darker .mtk4 { color: #F78C6C; }\n.material-theme-darker .mtk5 { color: #89DDFF; }\n.material-theme-darker .mtk6 { color: #C3E88D; }\n.material-theme-darker .mtk7 { color: #FFCB6B; }\n.material-theme-darker .mtk8 { color: #EEFFFF; }\n.material-theme-darker .mtk9 { color: #82AAFF; }\n.material-theme-darker .mtk10 { color: #FF5370; }\n.material-theme-darker .mtk11 { color: #F07178; }\n.material-theme-darker .mtk12 { color: #C792EA; }\n.material-theme-darker .mtk13 { color: #EEFFFF90; }\n.material-theme-darker .mtk14 { color: #65737E; }\n.material-theme-darker .mtk15 { color: #B2CCD6; }\n.material-theme-darker .mtk16 { color: #C17E70; }\n.material-theme-darker .mtki { font-style: italic; }\n.material-theme-darker .mtkb { font-weight: bold; }\n.material-theme-darker .mtku { text-decoration: underline; text-underline-position: under; }\n`}</style>\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}