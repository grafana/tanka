{"version":3,"sources":["webpack:///./docs/libraries/overriding.md"],"names":["_frontmatter","Object","isExtensible","prototype","hasOwnProperty","call","defineProperty","configurable","value","name","filename","layoutProps","MDXLayout","DefaultLayout","MDXContent","_ref","components","props","_objectWithoutProperties","_excluded","mdx","_extends","mdxType","parentName","isMDXComponent"],"mappings":"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","file":"component---docs-libraries-overriding-md-05ab3d228effd83480e2.js","sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n/* @jsx mdx */\nimport DefaultLayout from \"/home/runner/work/tanka/tanka/docs/node_modules/gatsby-theme-docz/src/base/Layout.js\";\nexport const _frontmatter = {};\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"overriding-vendor\"\n    }}>{`Overriding vendor`}</h1>\n    <p>{`The `}<inlineCode parentName=\"p\">{`vendor`}</inlineCode>{` directory is immutable in its nature. You can't and should never\nmodify any files inside of it, `}<inlineCode parentName=\"p\">{`jb`}</inlineCode>{` will revert those changes on the next run anyway.`}</p>\n    <p>{`Nevertheless, it can sometimes become required to add changes there, e.g. if an\nupstream library contains a bug that needs to be fixed immediately, without\nwaiting for the upstream maintainer to review it.`}</p>\n    <h2 {...{\n      \"id\": \"shadowing\"\n    }}>{`Shadowing`}</h2>\n    <p>{`Because `}<a parentName=\"p\" {...{\n        \"href\": \"/pr-preview/pr-1020/libraries/import-paths\"\n      }}>{`import paths`}</a>{` are ranked in Tanka, you can use\na technique called shadowing: By putting a file with the exact same name in a\nhigher ranked path, Tanka will prefer that file instead of the original in\n`}<inlineCode parentName=\"p\">{`vendor`}</inlineCode>{`, which has the lowest possible rank of 1.`}</p>\n    <p>{`For example, if `}<inlineCode parentName=\"p\">{`/vendor/foo/bar.libsonnet`}</inlineCode>{` contained an error, you could create\n`}<inlineCode parentName=\"p\">{`/lib/foo/bar.libsonnet`}</inlineCode>{` and fix it there.`}</p>\n    <blockquote>\n      <p parentName=\"blockquote\"><strong parentName=\"p\">{`Tip:`}</strong>{` Instead of copying the file to the new location and making the edits,\nuse an absolute import and `}<a parentName=\"p\" {...{\n          \"href\": \"/pr-preview/pr-1020/tutorial/environments#patching\"\n        }}>{`patching`}</a>{`:`}</p>\n      <pre parentName=\"blockquote\" {...{\n        \"className\": \"material-theme-darker vscode-highlight\",\n        \"data-language\": \"jsonnet\"\n      }}><code parentName=\"pre\" {...{\n          \"className\": \"vscode-highlight-code\"\n        }}><span parentName=\"code\" {...{\n            \"className\": \"vscode-highlight-line\"\n          }}><span parentName=\"span\" {...{\n              \"className\": \"mtk3 mtki\"\n            }}>{`// in /lib/foo/bar.libsonnet:`}</span></span>{`\n`}<span parentName=\"code\" {...{\n            \"className\": \"vscode-highlight-line\"\n          }}><span parentName=\"span\" {...{\n              \"className\": \"mtk1\"\n            }}>{`(`}</span><span parentName=\"span\" {...{\n              \"className\": \"mtk4\"\n            }}>{`import`}</span><span parentName=\"span\" {...{\n              \"className\": \"mtk1\"\n            }}>{` `}</span><span parentName=\"span\" {...{\n              \"className\": \"mtk6\"\n            }}>{`\"../../vendor/foo/bar.libsonnet\"`}</span><span parentName=\"span\" {...{\n              \"className\": \"mtk1\"\n            }}>{`) `}</span><span parentName=\"span\" {...{\n              \"className\": \"mtk12\"\n            }}>{`+`}</span><span parentName=\"span\" {...{\n              \"className\": \"mtk1\"\n            }}>{` {`}</span></span>{`\n`}<span parentName=\"code\" {...{\n            \"className\": \"vscode-highlight-line\"\n          }}><span parentName=\"span\" {...{\n              \"className\": \"mtk1\"\n            }}>{`  `}</span><span parentName=\"span\" {...{\n              \"className\": \"mtk10\"\n            }}>{`foo+:`}</span><span parentName=\"span\" {...{\n              \"className\": \"mtk1\"\n            }}>{` {`}</span></span>{`\n`}<span parentName=\"code\" {...{\n            \"className\": \"vscode-highlight-line\"\n          }}><span parentName=\"span\" {...{\n              \"className\": \"mtk1\"\n            }}>{`    `}</span><span parentName=\"span\" {...{\n              \"className\": \"mtk10\"\n            }}>{`bar:`}</span><span parentName=\"span\" {...{\n              \"className\": \"mtk1\"\n            }}>{` `}</span><span parentName=\"span\" {...{\n              \"className\": \"mtk6\"\n            }}>{`\"fixed\"`}</span></span>{`\n`}<span parentName=\"code\" {...{\n            \"className\": \"vscode-highlight-line\"\n          }}><span parentName=\"span\" {...{\n              \"className\": \"mtk1\"\n            }}>{`  }`}</span></span>{`\n`}<span parentName=\"code\" {...{\n            \"className\": \"vscode-highlight-line\"\n          }}><span parentName=\"span\" {...{\n              \"className\": \"mtk1\"\n            }}>{`}`}</span></span></code></pre>\n    </blockquote>\n    <blockquote>\n      <p parentName=\"blockquote\"><strong parentName=\"p\">{`Important:`}</strong>{` If the file you override is not the one you directly import,\nbut instead imported by another file first, the override will only occur if\nthe placement of the file is alongside your `}<inlineCode parentName=\"p\">{`main.libsonnet`}</inlineCode>{`.  This is due to\nthe logic behind the Jsonnet importer.  Example:  We import\n`}<inlineCode parentName=\"p\">{`abc/main.libsonnet`}</inlineCode>{` located in `}<inlineCode parentName=\"p\">{`vendor/abc`}</inlineCode>{`.  Because Jsonnet first looks if\nfiles are locally present before considering the `}<a parentName=\"p\" {...{\n          \"href\": \"/pr-preview/pr-1020/libraries/import-paths\"\n        }}>{`import\npaths`}</a>{`, you need to make sure your override is\nactually picked up. In our example, you'd need to copy the `}<inlineCode parentName=\"p\">{`main.libsonnet`}</inlineCode>{`\ninto `}<inlineCode parentName=\"p\">{`lib/abc`}</inlineCode>{` as well.`}</p>\n    </blockquote>\n    <h2 {...{\n      \"id\": \"per-environment\"\n    }}>{`Per environment`}</h2>\n    <p>{`Another common case is overriding the entire `}<inlineCode parentName=\"p\">{`vendor`}</inlineCode>{` bundle per environment.`}</p>\n    <p>{`This is handy, when you for example want to test a change of an upstream\nlibrary which is used in many environments (including `}<inlineCode parentName=\"p\">{`prod`}</inlineCode>{`) in a single one,\nwithout affecting all the others.`}</p>\n    <p>{`For this, Tanka lets you have a separate `}<inlineCode parentName=\"p\">{`vendor`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`jsonnetfile.json`}</inlineCode>{` and\n`}<inlineCode parentName=\"p\">{`jsonnetfile.lock.json`}</inlineCode>{` per environment. To do so:`}</p>\n    <h4 {...{\n      \"id\": \"create-tkrcyaml\"\n    }}>{`Create `}<inlineCode parentName=\"h4\">{`tkrc.yaml`}</inlineCode></h4>\n    <p>{`Tanka normally uses the `}<inlineCode parentName=\"p\">{`jsonnetfile.json`}</inlineCode>{` from your project to find its root.\nAs we are going to create another one of that down the tree in the next step, we\nneed another marker for `}<inlineCode parentName=\"p\">{`<rootDir>`}</inlineCode>{`.`}</p>\n    <p>{`For that, create an empty file called `}<inlineCode parentName=\"p\">{`tkrc.yaml`}</inlineCode>{` in your project's root,\nalongside the original `}<inlineCode parentName=\"p\">{`jsonnetfile.json`}</inlineCode>{`.`}</p>\n    <blockquote>\n      <p parentName=\"blockquote\"><strong parentName=\"p\">{`Info`}</strong>{`: While the name suggests that `}<inlineCode parentName=\"p\">{`tkrc.yaml`}</inlineCode>{` could be used for setting\nparameters, this is not the case yet.`}<br parentName=\"p\"></br>{`\n`}{`It might however be repurposed later, in case we need such functionality`}</p>\n    </blockquote>\n    <h4 {...{\n      \"id\": \"add-a-vendor-to-your-environment\"\n    }}>{`Add a `}<inlineCode parentName=\"h4\">{`vendor`}</inlineCode>{` to your environment`}</h4>\n    <p>{`In your environments folder (e.g. `}<inlineCode parentName=\"p\">{`/environments/default`}</inlineCode>{`):`}</p>\n    <pre {...{\n      \"className\": \"material-theme-darker vscode-highlight\",\n      \"data-language\": \"bash\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk3 mtki\"\n          }}>{`# init jsonnet bundler (creates jsonnetfile.json)`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`$ jb init`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}></span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk3 mtki\"\n          }}>{`# install the updated dependency`}</span></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}><span parentName=\"span\" {...{\n            \"className\": \"mtk1\"\n          }}>{`$ jb install github.com/foo/bar@v2`}</span></span></code></pre>\n    <blockquote>\n      <p parentName=\"blockquote\"><strong parentName=\"p\">{`Tip`}</strong>{`: You don't need to install everything into the new `}<inlineCode parentName=\"p\">{`vendor/`}</inlineCode>{`, as\npackages not present there can still be imported from the global `}<inlineCode parentName=\"p\">{`/vendor`}</inlineCode>{`.`}</p>\n    </blockquote>\n\n    <style {...{\n      \"className\": \"vscode-highlight-styles\"\n    }}>{`\n  \n  .material-theme-darker {\nbackground-color: #212121;\ncolor: #EEFFFF;\n}\n\n.material-theme-darker .mtk1 { color: #FFFFFF; }\n.material-theme-darker .mtk2 { color: #212121; }\n.material-theme-darker .mtk3 { color: #545454; }\n.material-theme-darker .mtk4 { color: #F78C6C; }\n.material-theme-darker .mtk5 { color: #89DDFF; }\n.material-theme-darker .mtk6 { color: #C3E88D; }\n.material-theme-darker .mtk7 { color: #FFCB6B; }\n.material-theme-darker .mtk8 { color: #EEFFFF; }\n.material-theme-darker .mtk9 { color: #82AAFF; }\n.material-theme-darker .mtk10 { color: #FF5370; }\n.material-theme-darker .mtk11 { color: #F07178; }\n.material-theme-darker .mtk12 { color: #C792EA; }\n.material-theme-darker .mtk13 { color: #EEFFFF90; }\n.material-theme-darker .mtk14 { color: #65737E; }\n.material-theme-darker .mtk15 { color: #B2CCD6; }\n.material-theme-darker .mtk16 { color: #C17E70; }\n.material-theme-darker .mtki { font-style: italic; }\n.material-theme-darker .mtkb { font-weight: bold; }\n.material-theme-darker .mtku { text-decoration: underline; text-underline-position: under; }\n`}</style>\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}